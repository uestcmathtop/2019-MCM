% https://www.latex-tutorial.com/tutorials/pgfplotstable/

% CSV(comma-separated value) to LaTeX

\documentclass{article}

\usepackage{booktabs} % For \toprule, \midrule and \bottomrule
\usepackage{siunitx} % Formats the units and values
\usepackage{pgfplotstable} % Generates table from .csv
\usepackage{rotating}

% Setup siunitx:
\sisetup{
  round-mode          = places, % Rounds numbers
  round-precision     = 2, % to 2 places
}

\begin{document}

\begin{sidewaystable}[h!]
	\begin{center}
		\caption{Autogenerated table from .csv file.}
		\label{table1}
		\pgfplotstabletypeset[
			multicolumn names, % allows to have multicolumn names
			col sep=comma, % the seperator in our .csv file
			display columns/0/.style={
					column name=$Column 1$, % name of first column
					column type={c},string type},  % use siunitx for formatting
			display columns/1/.style={
					column name=$Value 2$,
          column type={c},string type},
      display columns/2/.style={
					column name=$Value 2$,
          column type={c},string type},
      display columns/3/.style={
          column name=$Value 3$,
          column type={c},string type},
      display columns/4/.style={
					column name=$Value 4$,
          column type={c},string type},
      display columns/5/.style={
					column name=$Value 5$,
					column type={c},string type},
      display columns/6/.style={
            column name=$Value 6$,
            column type={c},string type},
      every head row/.style={
					before row={\toprule}, % have a rule at top
					after row={
							\si{\ampere} & \si{\volt}\\ % the units seperated by &
							\midrule} % rule under units
				},
			every last row/.style={after row=\bottomrule}, % rule at bottom
		]{addresses.csv} % filename/path to file
	\end{center}
\end{sidewaystable}

\end{document}